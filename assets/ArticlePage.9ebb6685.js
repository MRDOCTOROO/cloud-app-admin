var ue=Object.defineProperty;var ce=(e,u,r)=>u in e?ue(e,u,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[u]=r;var P=(e,u,r)=>(ce(e,typeof u!="symbol"?u+"":u,r),r);import{D as de,F as pe,v as me,u as fe,A as oe,q as ge,a as ve,G as X,H as he,I as _e,J as ye}from"./element-plus.c5a782c8.js";import{_ as be}from"./CTable.8187ebd4.js";import{m as H,r as p,w as G,e as z,k as we,R as I,o as k,c as N,X as y,Q as g,F as Q,a6 as Se,P as O,M as W,J as le,T as M,al as Z,U as K,u as o,d as ne,aw as Ce,V as $,W as q,S as ee,a8 as ke,n as te,a0 as re,a3 as Re,a as T}from"./@vue.471b3eda.js";import{j as Fe,k as ze}from"./@element-plus.20a32ed7.js";import{u as L}from"./vue-i18n.8a81c414.js";import{h as ae}from"./index.b1ab9228.js";import{u as j}from"./useMessage.12534f46.js";import{c as xe}from"./@vueuse.5781ec6b.js";import"./lodash-es.032e1c7e.js";import"./@popperjs.36402333.js";import"./@ctrl.82a509e0.js";import"./dayjs.fa2946e5.js";import"./axios.095b39ac.js";import"./async-validator.fb49d0f5.js";import"./memoize-one.4ee5c96d.js";import"./escape-html.e5dfadb9.js";import"./normalize-wheel-es.1c4ac15a.js";import"./@floating-ui.cba15af0.js";import"./@intlify.7ce2fd17.js";import"./vue-echarts.bafe5eb1.js";import"./resize-detector.4e96b72b.js";import"./echarts.031788f5.js";import"./tslib.60310f1a.js";import"./zrender.2c4f8a45.js";import"./pinia.cd725b69.js";import"./vue-demi.65474690.js";import"./xe-utils.a7d87cf6.js";/* empty css                     */import"./vxe-table.2b2c2c4d.js";import"./vue-router.cd55c074.js";import"./qs.d8de42ab.js";import"./side-channel.883eaff8.js";import"./get-intrinsic.89e72507.js";import"./has-symbols.caae0f97.js";import"./function-bind.cb3858f2.js";import"./has.c1051c46.js";import"./call-bind.b701f999.js";import"./object-inspect.3f4be82e.js";import"./js-cookie.31874410.js";import"./nprogress.50279e12.js";const se=H({__name:"CForm",props:{options:{type:Array,require:!0},gutter:{type:Number,default:24},colSpan:{type:Object,require:!1},value:{type:Object,require:!0,default:()=>{}},loading:{type:Boolean,default:!1}},emits:["submit","update:value"],setup(e,{expose:u,emit:r}){const n=e,c={input:"el-input",select:"el-select",inputNumber:"el-input-number",timePicker:"el-time-picker",datePicker:"el-date-picker"},C=["el-input","el-input-number"],v=p(),R=p({}),h=p([]),b=p({});G(()=>n.options,l=>{const i={};h.value=l.map(S=>{let{name:F,type:s,rules:_,tagName:t,...B}=S;return _&&(i[F]=_),c[s]&&!t&&(t=c[s]),{...B,name:F,tagName:t}}),R.value=i},{immediate:!0});const m=z(()=>{const l=n.options&&n.options.length>10?{md:12,xs:24}:{span:24};return n.colSpan||l});async function f(){var l;await((l=v.value)==null?void 0:l.validate(i=>{if(i){const S=n.value;r("submit",S)}}))}function V(...l){var i;(i=v.value)==null||i.validateField(...l)}function E(...l){var i;(i=v.value)==null||i.validate(...l)}function d(...l){var i;(i=v.value)==null||i.resetFields(...l)}function w(...l){var i;(i=v.value)==null||i.clearValidate(...l)}return u({validateField:V,validate:E,resetFields:d,clearValidate:w,submit:f}),G(()=>n.value,l=>{b.value=l},{immediate:!0}),we(()=>{r("update:value",b.value)}),(l,i)=>{const S=de,F=me,s=fe,_=oe;return I((k(),N("div",null,[y(o(pe),W({ref_key:"formRef",ref:v,rules:R.value,model:e.value},l.$attrs),{default:g(()=>[y(s,{gutter:e.gutter},{default:g(()=>[(k(!0),N(Q,null,Se(h.value,(t,B)=>(k(),N(Q,{key:B},[t.hidden?K("",!0):(k(),O(F,W({key:0},t.colSpan||o(m),{key:t.name}),{default:g(()=>[y(S,W({prop:t.name,label:t.label},t.itemExtra),{default:g(()=>{var A,U;return[t.scopedSlot&&l.$slots[t.scopedSlot]?le(l.$slots,t.scopedSlot,{key:0,value:e.value,option:t}):t.tagName?(k(),N(Q,{key:1},[C.includes(t.tagName)?(k(),O(M(t.tagName),W({key:0,modelValue:b.value[t.name],"onUpdate:modelValue":a=>b.value[t.name]=a,modelModifiers:{trim:!0}},t.props,Z((A=t.on)!=null?A:{})),null,16,["modelValue","onUpdate:modelValue"])):(k(),O(M(t.tagName),W({key:1,modelValue:b.value[t.name],"onUpdate:modelValue":a=>b.value[t.name]=a},t.props,Z((U=t.on)!=null?U:{})),null,16,["modelValue","onUpdate:modelValue"]))],64)):K("",!0)]}),_:2},1040,["prop","label"])]),_:2},1040))],64))),128))]),_:3},8,["gutter"])]),_:3},16,["rules","model"])])),[[_,e.loading]])}}}),Ee=H({__name:"SearchFilter",props:{options:{type:Array,required:!0},model:{type:Object,required:!0},loading:{type:Boolean,default:!1},searchDisabled:{type:Boolean,default:!1},resetDisabled:{type:Boolean,default:!1},showExpand:{type:Boolean,default:!1},showReset:{type:Boolean,default:!0}},emits:["search","reset"],setup(e,{emit:u}){const r=e,n=p(!1),c=p(0),C=p(!0),v=p(0),R=300,h=p(),b=p({}),{t:m}=L(),f=z(()=>{let a=Math.floor(c.value/R)||3;return a>4&&(a=4),a<1&&(a=1),a}),V=z(()=>r.showExpand&&l.value.length>f.value),E=z(()=>({span:24/f.value})),d=z(()=>r.options.filter(a=>!a.hidden)),w=z(()=>{let a=[],x=E.value.span;if(d.value.length<f.value-1)x=(f.value-d.value.length%f.value)*24/f.value,a=[...d.value];else for(let D=0;D<d.value.length;D++){const J=d.value[D];if(a.push(J),a.length>=f.value-1)break}return a.push({name:"search",scopedSlot:"search",colSpan:{span:x}}),a}),l=z(()=>{const a=(f.value-d.value.length%f.value)*24/f.value;return[...d.value,{name:"search",scopedSlot:"search",colSpan:{span:a}}]}),i=z(()=>n.value||!r.showExpand?l:w.value),S=p();function F(a){u("search",a)}function s(){var a;(a=h.value)==null||a.submit()}function _(){t(),te(()=>{u("reset")})}function t(...a){h.value.resetFields(...a)}function B(){n.value=!n.value}function A(){!C.value||(C.value=!1,v.value=setTimeout(()=>{S.value&&(c.value=S.value.offsetWidth,C.value=!0)},300))}function U(){te(()=>{c.value=S.value.clientWidth}),window.addEventListener("resize",A,!1)}return G(()=>r.model,a=>{b.value=a},{immediate:!0}),ne(()=>{U()}),Ce(()=>{}),(a,x)=>{const D=X,J=ge,Y=ve;return k(),N("div",{ref_key:"filterWrapRef",ref:S},[y(se,W({ref_key:"form",ref:h},a.$attrs,{value:b.value,"onUpdate:value":x[0]||(x[0]=ie=>b.value=ie),options:o(i).value,layout:"inline","col-span":o(E),gutter:12,onSubmit:F,onKeyup:ke(s,["enter"])}),{search:g(()=>[y(J,null,{default:g(()=>[y(D,{type:"primary",icon:"search",loading:e.loading,disabled:e.searchDisabled,onClick:s},{default:g(()=>[$(q(o(m)("page.common.btn.search")),1)]),_:1},8,["loading","disabled"]),e.showReset?(k(),O(D,{key:0,type:"primary",icon:"brush",loading:e.loading,disabled:e.resetDisabled,onClick:_},{default:g(()=>[$(q(o(m)("page.common.btn.reset")),1)]),_:1},8,["loading","disabled"])):K("",!0)]),_:1})]),default:g(()=>[le(a.$slots,"extraButtons",{loading:e.loading}),o(V)?(k(),N("a",{key:0,onClick:B},[$(q(n.value?"\u6536\u8D77":"\u5C55\u5F00")+" ",1),I(y(Y,null,{default:g(()=>[(k(),O(M(o(Fe))))]),_:1},512),[[ee,n.value]]),I(y(Y,null,{default:g(()=>[(k(),O(M(o(ze))))]),_:1},512),[[ee,!n.value]])])):K("",!0)]),_:3},16,["value","options","col-span","onKeyup"])],512)}}});class Ve{constructor(u){P(this,"dataSource",p([]));P(this,"loading",p(!1));P(this,"queryParam",p());P(this,"url",p({}));P(this,"modalFormRef",p());P(this,"drawerFormRef",p());P(this,"ipagination",re({current:1,total:0,pageSize:10,pageSizeOptions:[5,10,20,50,100]}));this.url.value=u}}function De(e){const u=new Ve(e),{t:r}=L(),{dataSource:n,ipagination:c,loading:C,queryParam:v,modalFormRef:R,drawerFormRef:h}=Re(re(u)),b=()=>({page:c.value.current,pageSize:c.value.pageSize,...v.value}),m=async(s=!1)=>{if(!e.list){j("error",r("page.common.notice.set_url_list"));return}s&&(c.value.current=1);const _=b();try{C.value=!0;const t=await ae.get(e.list,_);n.value=t.data,c.value.total=t.total}finally{C.value=!1}},f=()=>{R.value.edit({}),R.value.title=r("page.common.title.add")},V=s=>{v.value=s,m(!0)},E=()=>{v.value={},m(!0)},d=(s,_=r("page.common.title.edit"))=>{R.value.edit(s),R.value.title=_},w=async s=>{if(!e.delete){j("error",r("page.common.notice.set_url_delete"));return}const _=await ae.post(e.delete,{params:{id:s}});_.code===200&&_.data.count>0&&(j("success",r("page.common.notice.delete_success")),m(!0))},l=()=>{h.value.add(),h.value.title=r("page.common.title.add")},i=(s,_=r("page.common.title.edit"))=>{h.value.edit(s),h.value.title=_},S=s=>{c.value.pageSize=s,m()},F=s=>{c.value.current=s,m()};return ne(async()=>{await m(!0)}),{loadData:m,handleAdd:f,handleEdit:d,handleReset:E,handleDelete:w,handleSearch:V,handleAddDrawer:l,handleEditDrawer:i,handleSizeChange:S,handleCurrentChange:F,dataSource:n,ipagination:c,modalFormRef:R,loading:C}}const Pe={class:"dialog-footer"},Oe=H({__name:"ArticleEditDialog",emits:["close"],setup(e,{expose:u,emit:r}){const{t:n}=L(),c=p(!1),C=p(),v=p(""),{width:R}=xe(),h=p({}),b=z(()=>R.value>768?"50%":"80%");function m(d){h.value=Object.assign({},d),c.value=!0}function f(){var d;(d=C.value)==null||d.clearValidate(),c.value=!1}async function V(d){!d||await d.validate(w=>{w&&(j("success",n("page.common.notice.submit_success")),r("close"),c.value=!1)})}const E=z(()=>[{name:"title",type:"input",label:n("page.common.design.article.form.title"),rules:[{required:!0,message:n("page.common.design.article.form.title_placeholder"),trigger:"blur"}],props:{maxLength:50,placeholder:n("page.common.design.article.form.title_placeholder")}},{name:"content",type:"input",label:n("page.common.design.article.form.content"),rules:[{required:!0,message:n("page.common.design.article.form.content_placeholder"),trigger:"blur"}],props:{autosize:{minRows:4,maxRows:8},type:"textarea",placeholder:n("page.common.design.article.form.content_placeholder")}}]);return u({edit:m,title:v}),(d,w)=>{const l=X,i=se,S=he;return k(),O(S,{modelValue:c.value,"onUpdate:modelValue":w[2]||(w[2]=F=>c.value=F),width:o(b),title:v.value,onClose:f},{footer:g(()=>[T("span",Pe,[y(l,{onClick:f},{default:g(()=>[$(q(o(n)("page.common.btn.cancel")),1)]),_:1}),y(l,{type:"primary",onClick:w[0]||(w[0]=F=>V(C.value))},{default:g(()=>[$(q(o(n)("page.common.btn.confirm")),1)]),_:1})])]),default:g(()=>[y(i,{ref_key:"ruleFormRef",ref:C,value:h.value,"onUpdate:value":w[1]||(w[1]=F=>h.value=F),"label-width":"80px",options:o(E)},null,8,["value","options"])]),_:1},8,["modelValue","width","title"])}}}),Be=()=>{const{t:e}=L(),u=z(()=>[{label:e("page.common.design.article.search.title"),name:"title",tagName:"el-input",props:{placeholder:e("page.common.design.article.search.title_placeholder"),maxLength:"24"}},{label:e("page.common.design.article.search.content"),name:"content",tagName:"el-input",props:{placeholder:e("page.common.design.article.search.content_placeholder"),maxLength:"24"}}]),r=z(()=>[{prop:"id",label:e("page.common.design.article.column.id"),width:"80"},{prop:"title",label:e("page.common.design.article.column.title"),width:"180"},{prop:"content",label:e("page.common.design.article.column.content"),showOverflowTooltip:!0},{prop:"actions",label:e("page.common.design.article.column.action"),fixed:"right",scoped:"actions",width:"150"}]);return{articleFilterOptions:u,articleColumns:r}},Ne={class:"relative w-full"},$e={class:"p-[8px] absolute w-full"},qe={class:"mx-3 mt-5"},Ae={class:"float-right mt-2"},Ft=H({__name:"ArticlePage",setup(e){const{t:u}=L(),r={list:"/article",delete:"/deleteArticle"},n={title:"",content:""},{articleFilterOptions:c,articleColumns:C}=Be(),v=p(n),R=z(()=>c.value),{loading:h,dataSource:b,ipagination:m,modalFormRef:f,loadData:V,handleSizeChange:E,handleCurrentChange:d,handleEdit:w,handleDelete:l,handleSearch:i,handleReset:S}=De(r);return(F,s)=>{const _=Ee,t=X,B=_e,A=be,U=ye,a=oe;return k(),N("div",Ne,[T("div",$e,[T("div",qe,[y(_,{model:v.value,options:o(R),"show-reset":!0,onReset:o(S),onSearch:o(i)},null,8,["model","options","onReset","onSearch"])]),I((k(),O(A,{"table-data":o(b),columns:o(C),align:"right","header-align":"right",stripe:"",style:{width:"100%"}},{actions:g(x=>[y(t,{size:"small",onClick:D=>o(w)(x.row)},{default:g(()=>[$(q(o(u)("page.common.btn.edit")),1)]),_:2},1032,["onClick"]),y(B,{title:o(u)("page.common.btn.delete_popover"),onConfirm:D=>o(l)(x.row.id)},{reference:g(()=>[y(t,{size:"small",type:"danger"},{default:g(()=>[$(q(o(u)("page.common.btn.delete")),1)]),_:1})]),_:2},1032,["title","onConfirm"])]),_:1},8,["table-data","columns"])),[[a,o(h)]]),T("div",Ae,[y(U,{currentPage:o(m).current,"onUpdate:currentPage":s[0]||(s[0]=x=>o(m).current=x),"page-size":o(m).pageSize,"onUpdate:page-size":s[1]||(s[1]=x=>o(m).pageSize=x),small:"","page-sizes":o(m).pageSizeOptions,background:!0,layout:"sizes, prev, pager, next",total:o(m).total,onSizeChange:o(E),onCurrentChange:o(d)},null,8,["currentPage","page-size","page-sizes","total","onSizeChange","onCurrentChange"])])]),y(Oe,{ref_key:"modalFormRef",ref:f,onClose:o(V)},null,8,["onClose"])])}}});export{Ft as default};
